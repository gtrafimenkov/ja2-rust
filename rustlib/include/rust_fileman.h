#pragma once

/* Warning, this file is autogenerated by cbindgen. Don't modify this manually. */

#include <stdarg.h>
#include <stdbool.h>
#include <stdint.h>
#include <stdlib.h>

/**
 * Special FileID value meaning an error.
 */
#define FILE_ID_ERR 0

enum FileSeekMode {
  FILE_SEEK_START = 1,
  FILE_SEEK_END = 2,
  FILE_SEEK_CURRENT = 4,
};

/**
 * Identifier of an open file.  The file can be a regular file or
 * a file inside of an slf archive.  This is opaque to the user of the library.
 */
typedef uint32_t FileID;

#ifdef __cplusplus
extern "C" {
#endif // __cplusplus

/**
 * Register slf libraries from directory `dir_path`.
 * `dir_path` must be utf-8 encoded string.
 * Return false, if there were any errors.
 */
bool File_RegisterSlfLibraries(const char *dir_path);

/**
 * Open file for reading.  `path` must be utf-8 encoded string.
 * The file can be a regular file or a file from a loaded slf archive.
 * If file is not found or any other error happened, return FILE_ID_ERR.
 */
FileID File_OpenForReading(const char *path);

/**
 * Open file for appending.  If the file doesn't exist, it will be created
 * and opened for writing.
 * `path` must be utf-8 encoded string.
 * A recular file will be created in the process.
 * Writing to an slf library file is not supported.
 */
FileID File_OpenForAppending(const char *path);

/**
 * Open file for writing.  `path` must be utf-8 encoded string.
 * A recular file will be created in the process.
 * Writing to an slf library file is not supported.
 */
FileID File_OpenForWriting(const char *path);

/**
 * Get Windows handle that can be used to read the file.
 * The file position will be changed to point to the corrent place
 * in the slf file if the file_id belongs to a library file.
 *
 * The handle must be used as soon as possible before other operations
 * on files from the same slf archive will change the file position.
 *
 * On Linux 0 is returned.  In case of an error, 0 is returned.
 */
uint64_t File_GetWinHandleToReadFile(FileID file_id);

/**
 * Read data from earlier opened file to the buffer.
 * Buffer must be no less than bytes_to_read in size.
 *
 * # Safety
 *
 * `bytes_read` can be null.
 */
bool File_Read(FileID file_id, void *buf, uint32_t bytes_to_read, uint32_t *bytes_read);

/**
 * Write data to an earlier opened file.
 *
 * # Safety
 *
 * `bytes_written` can be null.
 */
bool File_Write(FileID file_id, const void *buf, uint32_t bytes_to_write, uint32_t *bytes_written);

/**
 * Check if a file exists (regular or inside of slf library).
 */
bool File_Exists(const char *path);

/**
 * Get size of a file.  In case of an error, return 0.
 */
uint32_t File_GetSize(FileID file_id);

/**
 * Return size of the file.  Return 0 in case of an error.
 */
uint32_t File_Size(const char *path);

/**
 * Change file read or write position.
 */
bool File_Seek(FileID file_id, uint32_t distance, enum FileSeekMode how);

/**
 * Close earlie opened file.
 */
bool File_Close(FileID file_id);

/**
 * Return true if the file is inside slf archive.
 */
bool File_IsInsideArchive(FileID file_id);

#ifdef __cplusplus
} // extern "C"
#endif // __cplusplus
